<style>
  #featuredSlider::-webkit-scrollbar {
    display: none;
  }
  #featuredSlider {
    scrollbar-width: none;
  }
  .left-button {
    z-index: 1;
    border: 2px solid #e0bf50;
    border-radius: 50%;
    color: #e0bf50;
    background: rgba(255, 255, 255, 0.9);
    position: absolute !important;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }
  .right-button {
    z-index: 1;
    border: 2px solid #e0bf50;
    border-radius: 50%;
    color: #e0bf50;
    background: rgba(255, 255, 255, 0.9);
    position: absolute !important;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }
  .left-button:hover,
  .right-button:hover {
    background: #e0bf50;
    color: #fff;
    transform: translateY(-50%) scale(1.1);
  }
   .shop-header-section {
    position: relative;
    padding: 0;
    margin-bottom: 0;
  }

  .shop-card {
    background: #ffffff;
    border-radius: 20px;
    padding: 3rem;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
    border: 2px solid rgba(224, 191, 80, 0.1);
    max-width: 900px;
    position: relative;
    overflow: hidden;
    margin: 0 auto;
    transition: all 0.3s ease;
  }

  .shop-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 30px 80px rgba(224, 191, 80, 0.2);
    border-color: #e0bf50;
  }


  .shop-icon {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #ffd700, #ffed4e);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: #333;
    box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
  }

  .shop-name {
    color: #2c3e50;
    font-weight: 700;
    font-size: 1.4rem;
    margin: 0;
  }

  .shop-subtitle {
    color: #6c757d;
    font-size: 0.9rem;
    font-style: italic;
  }

  .shop-stats {
    margin-top: 15px;
  }

  .stat-item {
    text-align: center;
    padding: 10px 8px;
    background: linear-gradient(145deg, #f8f9fa, #ffffff);
    border-radius: 10px;
    border: 1px solid rgba(255, 215, 0, 0.1);
    transition: all 0.3s ease;
  }

  .stat-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255, 215, 0, 0.2);
  }

  .stat-icon {
    display: block;
    font-size: 1.2rem;
    color: #ffd700;
    margin-bottom: 5px;
  }

  .stat-number {
    display: block;
    font-size: 1.3rem;
    font-weight: 700;
    color: #2c3e50;
    line-height: 1;
  }

  .stat-label {
    display: block;
    font-size: 0.75rem;
    color: #6c757d;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 500;
  }

  .btn-change-shop {
    background: linear-gradient(135deg, #ffd700, #ffed4e);
    border: 2px solid #ffd700;
    color: #333;
    font-weight: 600;
    padding: 12px 24px;
    border-radius: 25px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-size: 0.9rem;
  }

  .btn-change-shop:hover {
    background: linear-gradient(135deg, #c0c0c0, #d6d6d6);
    border-color: #c0c0c0;
    color: #333;
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(192, 192, 192, 0.4);
  }

  .btn-change-shop:active {
    transform: translateY(0);
    box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
  }

  .btn-change-shop i {
    font-size: 1rem;
  }

  /* Language Toggle Button Styles */
  .language-toggle {
    position: fixed;
    top: 120px;
    right: 20px;
    z-index: 1000;
    background: linear-gradient(135deg, #e0bf50, #ffc107);
    border: 2px solid #e0bf50;
    color: #333;
    font-weight: 700;
    padding: 12px 16px;
    border-radius: 50px;
    box-shadow: 0 6px 20px rgba(224, 191, 80, 0.3);
    transition: all 0.3s ease;
    cursor: pointer;
    font-size: 0.9rem;
    min-width: 60px;
    text-align: center;
    backdrop-filter: blur(10px);
  }

  .language-toggle:hover {
    background: linear-gradient(135deg, #ffc107, #ffed4e);
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 8px 25px rgba(224, 191, 80, 0.4);
  }

  .language-toggle:active {
    transform: translateY(0) scale(1);
  }

  /* Hindi Font Support */
  .hindi {
    font-family: 'Noto Sans Devanagari', 'Mangal', 'Kruti Dev', sans-serif;
    font-weight: 500;
  }

  /* Mobile Responsiveness */
  @media (max-width: 768px) {
    .shop-card {
      margin: 0 15px;
      padding: 20px;
    }
    
    .shop-name {
      font-size: 1.2rem;
    }
    
    .shop-icon {
      width: 45px;
      height: 45px;
      font-size: 1.3rem;
    }
    
    .btn-change-shop {
      padding: 10px 20px;
      font-size: 0.85rem;
      width: 100%;
      margin-top: 10px;
    }
    
    .stat-item {
      padding: 8px 6px;
    }
    
    .stat-number {
      font-size: 1.1rem;
    }
    
    .stat-label {
      font-size: 0.7rem;
    }

    .language-toggle {
      top: 100px;
      right: 15px;
      padding: 10px 14px;
      font-size: 0.8rem;
      min-width: 55px;
    }
  }

  /* Animation for stats */
  @keyframes countUp {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .stat-number {
    animation: countUp 0.6s ease-out;
  }

  /* Luxury touches */
  .shop-card {
    transition: all 0.3s ease;
  }

  .shop-card:hover {
    transform: translateY(-2px);
    box-shadow: 
      0 12px 40px rgba(255, 215, 0, 0.15),
      0 4px 12px rgba(192, 192, 192, 0.15);
  }
  
  /* Mobile slider buttons */
  @media (max-width: 768px) {
    .left-button, .right-button {
      width: 35px;
      height: 35px;
      font-size: 0.9rem;
    }
    .left-button {
      left: 5px;
    }
    .right-button {
      right: 5px;
    }
  }

  /* Fade transition for language switch */
  .lang-transition {
    transition: opacity 0.3s ease;
  }

  /* Admin FAB Styles */
  .admin-fab-container {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 1000;
  }

  .main-fab {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #e0bf50, #ffc107);
    border: 2px solid #e0bf50;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(224, 191, 80, 0.3);
    color: #2c2c2c;
    font-size: 1.2rem;
  }

  .main-fab:hover {
    background: linear-gradient(135deg, #ffc107, #ffed4e);
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(224, 191, 80, 0.4);
  }

  .main-fab.active {
    transform: rotate(45deg) scale(1.1);
  }

  .fab-menu {
    position: absolute;
    bottom: 80px;
    right: 0;
    display: flex;
    flex-direction: column;
    gap: 15px;
    opacity: 0;
    visibility: hidden;
    transform: translateY(20px);
    transition: all 0.3s ease;
  }

  .fab-menu.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .fab-item {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #fff, #f8f9fa);
    border: 2px solid #e0bf50;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(224, 191, 80, 0.2);
    color: #e0bf50;
    font-size: 1rem;
    position: relative;
  }

  .fab-item:hover {
    background: linear-gradient(135deg, #e0bf50, #ffc107);
    color: #2c2c2c;
    transform: scale(1.1);
    box-shadow: 0 6px 15px rgba(224, 191, 80, 0.4);
  }

  .fab-tooltip {
    position: absolute;
    right: 60px;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(44, 44, 44, 0.9);
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 0.8rem;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    pointer-events: none;
  }

  .fab-item:hover .fab-tooltip {
    opacity: 1;
    visibility: visible;
    transform: translateY(-50%) translateX(-5px);
  }

  /* Mobile responsiveness */
  @media (max-width: 768px) {
    .main-fab {
      width: 50px;
      height: 50px;
      font-size: 1rem;
    }
    
    .fab-item {
      width: 45px;
      height: 45px;
      font-size: 0.9rem;
    }
    
    .admin-fab-container {
      bottom: 15px;
      right: 15px;
    }
  }
</style>

<% title = 'Home' %>
<%- include("../partials/head") %>
<%- include("../partials/header") %>

<!-- Flash Messages positioned absolutely to avoid spacing issues -->
<div class="flash-messages-container">
  <%- include('../partials/messages') %>
</div>

<style>
/* Complete fix for white space between header and hero */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  margin: 0 !important;
  padding: 0 !important;
}

/* Position flash messages absolutely to not affect layout */
.flash-messages-container {
  position: fixed;
  top: 80px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 9999;
  width: 100%;
  max-width: 500px;
  pointer-events: none;
}

.flash-messages-container .alert {
  pointer-events: all;
  margin: 0 auto 10px auto;
}

/* Remove all spacing around navbar */
.navbar {
  margin: 0 !important;
  padding-top: 0.75rem !important;
  padding-bottom: 0.75rem !important;
}

.navbar.sticky-top {
  margin-bottom: 0 !important;
  border-bottom: 2px solid #e0bf50;
}

/* Remove all spacing around hero */
.hero {
  margin: 0 !important;
  padding: 0 !important;
  min-height: 100vh;
  display: flex;
  align-items: center;
}

/* Ensure no gaps between sections */
section {
  margin: 0 !important;
}

/* Remove Bootstrap default margins */
.container-fluid {
  padding: 0 !important;
  margin: 0 !important;
}

/* Fix any spacing issues */
.navbar + section,
.navbar + div,
header + section,
header + div {
  margin-top: 0 !important;
  padding-top: 0 !important;
}
</style>

<%- include("../components/hero") %>

  <%- include("../components/about") %>



<!-- Language Toggle Button -->
<!-- <button class="language-toggle" id="languageToggle" onclick="toggleLanguage()">
  à¤¹à¤¿à¤‚
</button> -->

<% if (!session.selectedShop && !session.isSeller) { %>
  <%- include("./shop-selection") %>
<% } else { %>

  <!-- ðŸ” Change Shop Button -->
<section id="rate" class="shop-header-section py-5 bg-white">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="section-title mb-3" data-en="Current Shop" data-hi="à¤µà¤°à¥à¤¤à¤®à¤¾à¤¨ à¤¦à¥à¤•à¤¾à¤¨">Current Shop</h2>
      <div class="title-underline mx-auto"></div>
    </div>
    <!-- Shop Selection Card -->
    <div class="shop-card mx-auto position-relative">
      <!-- User Info Button in Top Corner - Visible only to shop owner -->
      
    <!-- User Info Button -->
<!-- User Info Button -->
<!-- User Info Button -->
<button class="btn btn-sm btn-outline-warning position-absolute top-0 end-0 m-3" 
    type="button"
    data-bs-toggle="modal" 
    data-bs-target="#userInfoModal"
    data-bs-toggle="tooltip" 
    data-bs-placement="left" 
    
    style="z-index: 1050; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
  <i class="fas fa-user"></i>
</button>

<!-- User Info Modal - Customer/Shop Info Only -->
<div class="modal" id="userInfoModal" tabindex="-1" aria-labelledby="userInfoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content rounded-4 shadow">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="userInfoModalLabel">
          <i class="fas fa-info-circle me-2"></i> 
          <% if (session.isSeller) { %>
            Shop Information
          <% } else { %>
            Customer Information
          <% } %>
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body py-4">

        <% if (session.isSeller && currentShop) { %>
          <!-- Shop Owner Information -->
          <div class="text-center mb-4">
            <div class="shop-icon mx-auto mb-3" style="width: 80px; height: 80px; background: linear-gradient(135deg, #ffd700, #ffed4e); border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: #333;">
              <i class="fas fa-store"></i>
            </div>
            <h4 class="mb-1"><%= currentShop.name %></h4>
            <p class="text-muted">Shop Owner</p>
          </div>

          <!-- Shop Details -->
          <div class="mb-3">
            <h6 class="text-uppercase text-muted mb-3">Shop Details</h6>
            
            <div class="row g-2">
              <div class="col-12">
                <div class="info-item p-3 bg-light rounded">
                  <i class="fas fa-envelope me-2 text-primary"></i>
                  <strong>Email:</strong> <%= currentShop.email %>
                </div>
              </div>
              
              <% if (currentShop.contactInfo && currentShop.contactInfo.phone) { %>
              <div class="col-12">
                <div class="info-item p-3 bg-light rounded">
                  <i class="fas fa-phone me-2 text-primary"></i>
                  <strong>Phone:</strong> <%= currentShop.contactInfo.phone %>
                </div>
              </div>
              <% } %>
              
              <% if (currentShop.location && (currentShop.location.address || currentShop.location.city)) { %>
              <div class="col-12">
                <div class="info-item p-3 bg-light rounded">
                  <i class="fas fa-map-marker-alt me-2 text-primary"></i>
                  <strong>Address:</strong> 
                  <%= currentShop.location.address || '' %><% if (currentShop.location.address && currentShop.location.city) { %>, <% } %><%= currentShop.location.city || '' %>
                  <% if (currentShop.location.state) { %>, <%= currentShop.location.state %><% } %>
                </div>
              </div>
              <% } %>
              
              <% if (currentShop.businessHours) { %>
              <div class="col-12">
                <div class="info-item p-3 bg-light rounded">
                  <i class="fas fa-clock me-2 text-primary"></i>
                  <strong>Business Hours:</strong><br>
                  <%= currentShop.businessHours.weekdays || 'Mon - Sat: 10:00 AM - 8:00 PM' %><br>
                  <%= currentShop.businessHours.sunday || 'Sunday: 11:00 AM - 6:00 PM' %>
                </div>
              </div>
              <% } %>
            </div>
          </div>

          <!-- Shop Stats -->
          <div class="mb-3">
            <h6 class="text-uppercase text-muted mb-3">Shop Statistics</h6>
            <div class="row g-2">
              <div class="col-4">
                <div class="stat-item text-center p-3 bg-warning bg-opacity-10 rounded">
                  <i class="fas fa-gem d-block text-warning mb-2" style="font-size: 1.5rem;"></i>
                  <strong><%= products ? products.length : 0 %></strong>
                  <div class="small text-muted">Products</div>
                </div>
              </div>
              <div class="col-4">
                <div class="stat-item text-center p-3 bg-success bg-opacity-10 rounded">
                  <i class="fas fa-check-circle d-block text-success mb-2" style="font-size: 1.5rem;"></i>
                  <strong><%= products ? products.filter(p => p.inStock).length : 0 %></strong>
                  <div class="small text-muted">In Stock</div>
                </div>
              </div>
              <div class="col-4">
                <div class="stat-item text-center p-3 bg-info bg-opacity-10 rounded">
                  <i class="fas fa-star d-block text-info mb-2" style="font-size: 1.5rem;"></i>
                  <strong><%= products ? products.filter(p => p.featured).length : 0 %></strong>
                  <div class="small text-muted">Featured</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Edit Profile Button -->
          <div class="text-center">
            <a href="/products/user/<%= session.userId %>/edit" class="btn btn-outline-primary">
              <i class="fas fa-edit me-2"></i> Update Shop Profile
            </a>
          </div>

        <% } else { %>
          <!-- Customer/Visitor Information -->
          <div class="text-center mb-4">
            <div class="customer-icon mx-auto mb-3" style="width: 80px; height: 80px; background: linear-gradient(135deg, #17a2b8, #20c997); border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: white;">
              <i class="fas fa-user"></i>
            </div>
            <% if (isLoggedIn && user && user.name !== 'Guest') { %>
              <h4 class="mb-1"><%= user.name %></h4>
              <p class="text-muted"><%= user.email %></p>
              <% if (user.contactInfo && user.contactInfo.phone) { %>
                <p class="text-muted small">
                  <i class="fas fa-phone me-1"></i> <%= user.contactInfo.phone %>
                </p>
              <% } %>
            <% } else { %>
              <h4 class="mb-1">Welcome Visitor</h4>
              <p class="text-muted">Browsing as Guest</p>
            <% } %>
          </div>

          <!-- Current Shop Being Browsed -->
          <% if (currentShop) { %>
          <div class="mb-3">
            <h6 class="text-uppercase text-muted mb-3">Currently Browsing</h6>
            <div class="info-item p-3 bg-light rounded text-center">
              <i class="fas fa-store me-2 text-primary"></i>
              <strong><%= currentShop.name %></strong>
              <div class="small text-muted mt-1">
                <%= products ? products.length : 0 %> products available
              </div>
              <% if (currentShop.contactInfo && currentShop.contactInfo.phone) { %>
                <div class="small text-muted mt-1">
                  <i class="fas fa-phone me-1"></i> <%= currentShop.contactInfo.phone %>
                </div>
              <% } %>
              <% if (currentShop.location && (currentShop.location.city || currentShop.location.address)) { %>
                <div class="small text-muted mt-1">
                  <i class="fas fa-map-marker-alt me-1"></i> 
                  <%= currentShop.location.city || currentShop.location.address %>
                </div>
              <% } %>
            </div>
          </div>
          <% } %>

          <!-- Session Info -->
          <div class="mb-3">
            <h6 class="text-uppercase text-muted mb-3">Session Information</h6>
            <div class="info-item p-3 bg-light rounded">
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <i class="fas fa-shopping-bag me-2 text-success"></i>
                  <strong>Shopping Session</strong>
                  <div class="small text-muted mt-1">
                    <% if (isLoggedIn) { %>
                      Logged in as registered user
                    <% } else { %>
                      Browsing as guest - No registration required
                    <% } %>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="text-center">
            <% if (currentShop) { %>
              <form action="/products/reset-shop" method="POST" class="d-inline">
                <button type="submit" class="btn btn-outline-warning me-2">
                  <i class="fas fa-exchange-alt me-2"></i> Change Shop
                </button>
              </form>
            <% } %>
            <% if (!isLoggedIn) { %>
              <a href="/products/login" class="btn btn-outline-primary">
                <i class="fas fa-sign-in-alt me-2"></i> Login
              </a>
            <% } %>
          </div>
        <% } %>

      </div>
    </div>
  </div>
</div>

<style>
.info-item {
  transition: all 0.3s ease;
  will-change: transform, box-shadow;
  backface-visibility: hidden;
  transform: translateZ(0);
}
.info-item:hover {
  transform: translateY(-2px) translateZ(0);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
.stat-item {
  transition: all 0.3s ease;
  will-change: transform;
  backface-visibility: hidden;
  transform: translateZ(0);
}
.stat-item:hover {
  transform: translateY(-2px) translateZ(0);
}

/* Complete fix for modal shaking - disable all animations and transforms in modal */
.modal * {
  transition: none !important;
  transform: none !important;
  animation: none !important;
}

.modal .info-item,
.modal .info-item:hover,
.modal .info-item:active,
.modal .info-item:focus {
  transform: none !important;
  box-shadow: none !important;
  transition: none !important;
  animation: none !important;
}

.modal .stat-item,
.modal .stat-item:hover,
.modal .stat-item:active,
.modal .stat-item:focus {
  transform: none !important;
  transition: none !important;
  animation: none !important;
}

/* Ensure modal content is completely stable */
.modal-content {
  transform: none !important;
  transition: none !important;
  animation: none !important;
}

.modal-body {
  transform: none !important;
  transition: none !important;
  animation: none !important;
}

.modal-body * {
  transform: none !important;
  transition: none !important;
  animation: none !important;
}

/* Disable any Bootstrap modal animations that might cause issues */
.modal.fade .modal-dialog {
  transition: none !important;
  transform: none !important;
}

.modal.show .modal-dialog {
  transform: none !important;
}

/* AGGRESSIVE FIX for userInfoModal - Complete CSS Reset */
#userInfoModal,
#userInfoModal *,
#userInfoModal *:before,
#userInfoModal *:after,
#userInfoModal *:hover,
#userInfoModal *:active,
#userInfoModal *:focus {
  transition: none !important;
  transform: none !important;
  animation: none !important;
  will-change: auto !important;
  backface-visibility: visible !important;
  perspective: none !important;
  transform-style: flat !important;
}

/* Force static positioning and remove any movement */
#userInfoModal .modal-content {
  position: static !important;
  transform: none !important;
  transition: none !important;
}

#userInfoModal .modal-dialog {
  transform: none !important;
  transition: none !important;
  margin: 1.75rem auto !important;
}

/* Remove all hover effects completely */
#userInfoModal .info-item,
#userInfoModal .stat-item,
#userInfoModal .customer-icon,
#userInfoModal .shop-icon,
#userInfoModal div,
#userInfoModal p,
#userInfoModal h1,
#userInfoModal h2,
#userInfoModal h3,
#userInfoModal h4,
#userInfoModal h5,
#userInfoModal h6 {
  transition: none !important;
  transform: none !important;
  animation: none !important;
  box-shadow: none !important;
}

#userInfoModal .info-item:hover,
#userInfoModal .stat-item:hover,
#userInfoModal div:hover,
#userInfoModal p:hover {
  transform: none !important;
  box-shadow: none !important;
  background-color: inherit !important;
  border: inherit !important;
  opacity: inherit !important;
}

/* Disable any Bootstrap animations */
#userInfoModal.show {
  display: block !important;
}

/* Force hardware acceleration off */
#userInfoModal * {
  transform: translateZ(0) !important;
  transform: none !important;
}

/* Fix user info button shaking on hover */
.btn-outline-warning {
  transition: all 0.2s ease !important;
  transform: translateZ(0);
  backface-visibility: hidden;
}

.btn-outline-warning:hover {
  transform: translateZ(0) !important;
  transition: all 0.2s ease !important;
}

/* Specific fix for user info button */
button[data-bs-target="#userInfoModal"] {
  transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease !important;
  transform: none !important;
  will-change: background-color, border-color, color;
}

button[data-bs-target="#userInfoModal"]:hover {
  transform: none !important;
  transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease !important;
}

/* Remove any transform effects from Bootstrap button hover */
.btn:hover {
  transform: none !important;
}

.btn-outline-warning:hover {
  transform: none !important;
}
</style>


      
      <div class="row align-items-center g-4">
        <!-- Current Shop Info -->
        <div class="col-lg-8 col-md-12">
          <% if (currentShop) { %>
            <div class="shop-info">
              <div class="d-flex align-items-center mb-3">
                <div class="shop-icon me-3">
                  <i class="fas fa-store"></i>
                </div>
                <div>
                  <h4 class="shop-name mb-1"><%= currentShop.name %></h4>
                  <p class="shop-subtitle mb-0 text-muted" data-en="Premium Jewellery Collection" data-hi="à¤ªà¥à¤°à¥€à¤®à¤¿à¤¯à¤® à¤†à¤­à¥‚à¤·à¤£ à¤¸à¤‚à¤—à¥à¤°à¤¹">Premium Jewellery Collection</p>
                </div>
              </div>
              
              <!-- Shop Stats -->
              <div class="shop-stats">
                <div class="row g-2">
                  <div class="col-4">
                    <div class="stat-item">
                      <i class="fas fa-gem stat-icon"></i>
                      <span class="stat-number"><%= products ? products.length : 0 %></span>
                      <span class="stat-label" data-en="Products" data-hi="à¤‰à¤¤à¥à¤ªà¤¾à¤¦">Products</span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="stat-item">
                      <i class="fas fa-star stat-icon"></i>
                      <span class="stat-number"><%= products ? products.filter(p => p.featured).length : 0 %></span>
                      <span class="stat-label" data-en="Featured" data-hi="à¤«à¥€à¤šà¤°à¥à¤¡">Featured</span>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="stat-item">
                      <i class="fas fa-check-circle stat-icon"></i>
                      <span class="stat-number"><%= products ? products.filter(p => p.inStock).length : 0 %></span>
                      <span class="stat-label" data-en="In Stock" data-hi="à¤¸à¥à¤Ÿà¥‰à¤• à¤®à¥‡à¤‚">In Stock</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          <% } else { %>
            <div class="shop-info">
              <h5 class="text-muted" data-en="No Shop Selected" data-hi="à¤•à¥‹à¤ˆ à¤¦à¥à¤•à¤¾à¤¨ à¤šà¤¯à¤¨à¤¿à¤¤ à¤¨à¤¹à¥€à¤‚">No Shop Selected</h5>
              <p class="mb-0" data-en="Please select a shop to browse products" data-hi="à¤‰à¤¤à¥à¤ªà¤¾à¤¦à¥‹à¤‚ à¤•à¥‹ à¤¦à¥‡à¤–à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤à¤• à¤¦à¥à¤•à¤¾à¤¨ à¤šà¥à¤¨à¥‡à¤‚">Please select a shop to browse products</p>
            </div>
          <% } %>
        </div>
        
        <!-- Action Buttons -->
        <div class="col-lg-4 col-md-12 text-center">
          <form action="/products/reset-shop" method="POST" class="d-inline">
            <button class="btn btn-change-shop btn-lg w-100">
              <i class="fas fa-exchange-alt me-2"></i>
              <span data-en="Change Shop" data-hi="à¤¦à¥à¤•à¤¾à¤¨ à¤¬à¤¦à¤²à¥‡à¤‚">Change Shop</span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>
  <hr>
  <%- include("../components/gold-rate-manager") %>
  <hr>

  <!-- ðŸ” Search and Category Filter -->
  <%- include("../components/search-filter") %>
  <%- include("../components/categories") %>
  <hr>

  <!-- ðŸŒŸ Featured Products - FIXED VERSION -->
<section id="featured" class="featured-products py-5 bg-white">
  <div class="container position-relative">
    <h2 class="section-title text-center mb-4" data-en="Featured Collection" data-hi="à¤«à¥€à¤šà¤°à¥à¤¡ à¤¸à¤‚à¤—à¥à¤°à¤¹">Featured Collection</h2>

    <!-- Slide Buttons -->
    <button class="btn left-button" id="slide-left" aria-label="Slide left">
      <i class="fa-solid fa-arrow-left"></i>
    </button>
    <button class="btn right-button" id="slide-right" aria-label="Slide right">
      <i class="fa-solid fa-arrow-right"></i>
    </button>

    <!-- Slider Container -->
    <div class="d-flex overflow-auto bg-white" id="featuredSlider" style="scroll-behavior: smooth; gap: 1rem; padding: 0 50px;">
      <% const featuredProducts = products.filter(p => p.featured); %>
      <% if (featuredProducts.length > 0) { %>
        <% featuredProducts.forEach(product => { %>
          <div class="card flex-shrink-0" style="width: 250px;">
            <% if (product.image && product.image !== 'default.png') { %>
              <img src="<%= product.image %>" class="card-img-top" alt="<%= product.name %>">
            <% } else { %>
              <img src="/images/default.png" class="card-img-top" alt="No image available">
            <% } %>
            <div class="card-body text-center">
              <h5 class="card-title"><%= product.name %></h5>
              <!-- FIXED: Added proper data attributes for price calculation -->
              <p class="card-text price"
                 data-metal="<%= (product.material || '').toLowerCase() %>"
                 data-weight="<%= product.specifications?.weight || 1 %>"
                 data-pricetype="<%= product.isManualPrice ? 'manual' : 'auto' %>"
                 data-manual="<%= product.price || 0 %>">
                â‚¹ <%= product.isManualPrice ? (product.price || 0).toFixed(2) : '0.00' %>
              </p>
              <a href="/products/<%= product._id %>" class="btn btn-sm btn-outline-warning">View More</a>
            </div>
          </div>
        <% }) %>
      <% } else { %>
        <div class="d-flex justify-content-center align-items-center w-100" style="height: 200px;">
          <p class="text-muted fs-5">No Featured Products Available</p>
        </div>
      <% } %>
    </div>
  </div>
</section>
  <hr>

 <!-- ðŸ›’ All Products - FIXED VERSION -->
<section id="all-collection"></section>
<section class="featured-products py-5 bg-white">
  <div class="container">
    <h2 class="section-title text-center" data-en="All Collection" data-hi="à¤¸à¤­à¥€ à¤¸à¤‚à¤—à¥à¤°à¤¹">All Collection</h2>
    <div class="row g-3 g-md-4">
      <% if (products.length > 0) { %>
        <% products.forEach(product => { %>
          <div class="col-6 col-md-4 col-lg-3">
            <div class="card shadow-sm h-100">
              <% if (product.image && product.image !== 'default.png') { %>
                <img src="<%= product.image %>" class="card-img-top" alt="<%= product.name %>">
              <% } else { %>
                <img src="/images/default.png" class="card-img-top" alt="No image available">
              <% } %>
              <div class="card-body text-center d-flex flex-column">
                <h5 class="card-title flex-grow-1"><%= product.name %></h5>
                <!-- FIXED: Added proper data attributes for price calculation -->
                <p class="card-text price mb-2"
                   data-metal="<%= (product.material || '').toLowerCase() %>"
                   data-weight="<%= product.specifications?.weight || 1 %>"
                   data-pricetype="<%= product.isManualPrice ? 'manual' : 'auto' %>"
                   data-manual="<%= product.price || 0 %>">
                  â‚¹ <%= product.isManualPrice ? (product.price || 0).toFixed(2) : '0.00' %>
                </p>
                <a href="/products/<%= product._id %>" class="btn btn-sm btn-outline-warning mt-auto">View More</a>
              </div>
            </div>
          </div>
        <% }) %>
      <% } else { %>
        <div class="d-flex justify-content-center align-items-center w-100" style="height: 200px;">
          <p class="text-muted fs-5">No Products Available</p>
        </div>
      <% } %>
    </div>
  </div>
</section>
  <hr>
  

  <!-- âž• Admin Actions (Combined FAB) -->
  <% if (session.isSeller) { %>
    <div class="admin-fab-container">
      <!-- Main FAB Button -->
      <div class="main-fab" id="mainFab" onclick="toggleAdminMenu()">
        <i class="fas fa-cog"></i>
      </div>
      
      <!-- Sub-buttons (hidden by default) -->
      <div class="fab-menu" id="fabMenu">
        <div class="fab-item" onclick="window.location.href='/products/add'">
          <i class="fas fa-plus"></i>
          <span class="fab-tooltip">Add Product</span>
        </div>
        <div class="fab-item" onclick="openMetalsManager()">
          <i class="fas fa-coins"></i>
          <span class="fab-tooltip">Metal Rates</span>
        </div>
        
        
        <div class="fab-item" onclick="window.location.href='/products/user/<%= session.userId %>/edit'">
          <i class="fas fa-edit"></i>
            <span class="fab-tooltip">Update Profile</span>
          </div>
        
        
        
      </div>
    </div>
  <% } %>

<% } %>

<!-- User Info Modal -->
<!-- <div class="modal fade" id="userInfoModal" tabindex="-1" aria-labelledby="userInfoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content rounded-4 shadow">
      <div class="modal-header border-0 bg-primary text-white">
        <h5 class="modal-title" id="userInfoModalLabel">
          <i class="fas fa-user-circle me-2"></i>
          <span data-en="User Information" data-hi="à¤‰à¤ªà¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€">User Information</span>
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body py-4">
        <div class="row g-3">
            <div class="col-12">
              <div class="d-flex align-items-center mb-3">
                <div class="user-avatar me-3">
                  <% if (session.user && session.user.profilePhoto) { %>
                    <img src="<%= session.user.profilePhoto %>" alt="Profile Photo" class="rounded-circle" style="width: 60px; height: 60px; object-fit: cover; border: 3px solid #007bff;">
                  <% } else { %>
                    <i class="fas fa-user-circle text-primary" style="font-size: 3rem;"></i>
                  <% } %>
                </div>
                <div>
                  <% if (session.user) { %>
                    <h6 class="mb-1 text-dark">
                      <span data-en="Name" data-hi="à¤¨à¤¾à¤®">Name</span>: <%= session.user.name || 'N/A' %>
                    </h6>
                    <p class="mb-0 text-muted">
                      <span data-en="Email" data-hi="à¤ˆà¤®à¥‡à¤²">Email</span>: <%= session.user.email || 'N/A' %>
                    </p>
                    <% if (session.user.mobile) { %>
                    <p class="mb-0 text-muted small">
                      <i class="fas fa-phone me-1"></i>
                      <span data-en="Mobile" data-hi="à¤®à¥‹à¤¬à¤¾à¤‡à¤²">Mobile</span>: <%= session.user.mobile %>
                    </p>
                    <% } %>
                  <% } else { %>
                    <h6 class="mb-1 text-warning">
                      <span data-en="Guest User" data-hi="à¤…à¤¤à¤¿à¤¥à¤¿ à¤‰à¤ªà¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾">Guest User</span>
                    </h6>
                    <p class="mb-0 text-muted">
                      <span data-en="Not logged in" data-hi="à¤²à¥‰à¤— à¤‡à¤¨ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆ">Not logged in</span>
                    </p>
                  <% } %>
                </div>
              </div>
            </div>
            
            <!-- <!-- <% if (session.user) { %>
            <!-- Contact Information -->
            <div class="col-md-6">
              <div class="info-card p-3 bg-light rounded">
                <h6 class="text-primary mb-2">
                  <i class="fas fa-phone me-2"></i>
                  <span data-en="Contact" data-hi="à¤¸à¤‚à¤ªà¤°à¥à¤•">Contact</span>
                </h6>
                <p class="mb-1 small">
                  <i class="fas fa-mobile-alt me-1"></i>
                  <span data-en="Mobile" data-hi="à¤®à¥‹à¤¬à¤¾à¤‡à¤²">Mobile</span>: <%= session.user.mobile || 'Not provided' %>
                </p>
                <p class="mb-0 small">
                  <i class="fas fa-envelope me-1"></i>
                  <span data-en="Email" data-hi="à¤ˆà¤®à¥‡à¤²">Email</span>: <%= session.user.email || 'N/A' %>
                </p>
              </div>
            </div>
            
            <!-- Location Information -->
            <div class="col-md-6">
              <div class="info-card p-3 bg-light rounded">
                <h6 class="text-success mb-2">
                  <i class="fas fa-map-marker-alt me-2"></i>
                  <span data-en="Location" data-hi="à¤¸à¥à¤¥à¤¾à¤¨">Location</span>
                </h6>
                <% if (session.user.location && (session.user.location.city || session.user.location.state)) { %>
                  <p class="mb-1 small">
                    <i class="fas fa-city me-1"></i>
                    <%= session.user.location.city || '' %><% if (session.user.location.city && session.user.location.state) { %>, <% } %><%= session.user.location.state || '' %>
                  </p>
                  <% if (session.user.location.pincode) { %>
                  <p class="mb-0 small">
                    <i class="fas fa-map-pin me-1"></i>
                    <span data-en="PIN" data-hi="à¤ªà¤¿à¤¨">PIN</span>: <%= session.user.location.pincode %>
                  </p>
                  <% } %>
                <% } else { %>
                  <p class="mb-0 small text-muted">
                    <span data-en="Not provided" data-hi="à¤ªà¥à¤°à¤¦à¤¾à¤¨ à¤¨à¤¹à¥€à¤‚ à¤•à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾">Not provided</span>
                  </p>
                <% } %>
              </div>
            </div>

            <!-- Personal Information -->
            <div class="col-md-6">
              <div class="info-card p-3 bg-info bg-opacity-10 rounded">
                <h6 class="text-info mb-2">
                  <i class="fas fa-user me-2"></i>
                  <span data-en="Personal Info" data-hi="à¤µà¥à¤¯à¤•à¥à¤¤à¤¿à¤—à¤¤ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€">Personal Info</span>
                </h6>
                <% if (session.user.gender) { %>
                <p class="mb-1 small">
                  <i class="fas fa-venus-mars me-1"></i>
                  <span data-en="Gender" data-hi="à¤²à¤¿à¤‚à¤—">Gender</span>: <%= session.user.gender %>
                </p>
                <% } %>
                <% if (session.user.dateOfBirth) { %>
                <p class="mb-1 small">
                  <i class="fas fa-birthday-cake me-1"></i>
                  <span data-en="DOB" data-hi="à¤œà¤¨à¥à¤® à¤¤à¤¿à¤¥à¤¿">DOB</span>: <%= new Date(session.user.dateOfBirth).toLocaleDateString() %>
                </p>
                <% } %>
                <% if (session.user.occupation) { %>
                <p class="mb-0 small">
                  <i class="fas fa-briefcase me-1"></i>
                  <span data-en="Occupation" data-hi="à¤µà¥à¤¯à¤µà¤¸à¤¾à¤¯">Occupation</span>: <%= session.user.occupation %>
                </p>
                <% } %>
                <% if (!session.user.gender && !session.user.dateOfBirth && !session.user.occupation) { %>
                <p class="mb-0 small text-muted">
                  <span data-en="Not provided" data-hi="à¤ªà¥à¤°à¤¦à¤¾à¤¨ à¤¨à¤¹à¥€à¤‚ à¤•à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾">Not provided</span>
                </p>
                <% } %>
              </div>
            </div>
            
            <!-- Account Information -->
            <!-- div class="col-md-6">
              <div class="info-card p-3 bg-warning bg-opacity-10 rounded">
                <h6 class="text-warning mb-2">
                  <i class="fas fa-shield-alt me-2"></i>
                  <span data-en="Account Info" data-hi="à¤–à¤¾à¤¤à¤¾ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€">Account Info</span>
                </h6>
                <p class="mb-1 small">
                  <i class="fas fa-user-tag me-1"></i>
                  <span data-en="Type" data-hi="à¤ªà¥à¤°à¤•à¤¾à¤°">Type</span>: 
                  <% if (session.isSeller) { %>
                    <span class="badge bg-warning text-dark" data-en="Seller" data-hi="à¤µà¤¿à¤•à¥à¤°à¥‡à¤¤à¤¾">Seller</span>
                  <% } else { %>
                    <span class="badge bg-info" data-en="Customer" data-hi="à¤—à¥à¤°à¤¾à¤¹à¤•">Customer</span>
                  <% } %>
                </p>
                <p class="mb-1 small">
                  <i class="fas fa-calendar-alt me-1"></i>
                  <span data-en="Member Since" data-hi="à¤¸à¤¦à¤¸à¥à¤¯ à¤¬à¤¨à¥‡">Member Since</span>: <%= new Date(session.user.createdAt).toLocaleDateString() %>
                </p>
                <p class="mb-0 small text-muted">
                  <i class="fas fa-id-badge me-1"></i>
                  ID: <%= session.user._id.toString().slice(-8) %>...
                </p>
              </div> 
            </div> -->

            <!-- Shop Information (for sellers) -->
            <% if (session.isSeller && session.user.shopInfo && session.user.shopInfo.shopName) { %>
            <div class="col-12">
              <div class="info-card p-3 bg-success bg-opacity-10 rounded">
                <h6 class="text-success mb-2">
                  <i class="fas fa-store me-2"></i>
                  <span data-en="Shop Information" data-hi="à¤¦à¥à¤•à¤¾à¤¨ à¤•à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€">Shop Information</span>
                </h6>
                <div class="row">
                  <div class="col-md-6">
                    <p class="mb-1 small">
                      <i class="fas fa-shop me-1"></i>
                      <span data-en="Shop Name" data-hi="à¤¦à¥à¤•à¤¾à¤¨ à¤•à¤¾ à¤¨à¤¾à¤®">Shop Name</span>: <%= session.user.shopInfo.shopName %>
                    </p>
                    <% if (session.user.shopInfo.gstNumber) { %>
                    <p class="mb-0 small">
                      <i class="fas fa-file-invoice me-1"></i>
                      <span data-en="GST" data-hi="à¤œà¥€à¤à¤¸à¤Ÿà¥€">GST</span>: <%= session.user.shopInfo.gstNumber %>
                    </p>
                    <% } %>
                  </div>
                  <div class="col-md-6">
                    <% if (session.user.shopInfo.shopDescription) { %>
                    <p class="mb-0 small">
                      <i class="fas fa-info-circle me-1"></i>
                      <span data-en="Description" data-hi="à¤µà¤¿à¤µà¤°à¤£">Description</span>: <%= session.user.shopInfo.shopDescription %>
                    </p>
                    <% } %>
                  </div>
                </div>
              </div>
            </div>
            <% } %>
            <% } else { %>
            <div class="col-12">
              <div class="info-card p-3 bg-warning bg-opacity-10 rounded text-center">
                <h6 class="text-warning mb-2">
                  <i class="fas fa-exclamation-triangle me-2"></i>
                  <span data-en="Login Required" data-hi="à¤²à¥‰à¤—à¤¿à¤¨ à¤†à¤µà¤¶à¥à¤¯à¤•">Login Required</span>
                </h6>
                <p class="mb-2 small">
                  <span data-en="Please log in to access full features" data-hi="à¤ªà¥‚à¤°à¥à¤£ à¤¸à¥à¤µà¤¿à¤§à¤¾à¤“à¤‚ à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤²à¥‰à¤— à¤‡à¤¨ à¤•à¤°à¥‡à¤‚">Please log in to access full features</span>
                </p>
                <a href="/login" class="btn btn-primary btn-sm">
                  <i class="fas fa-sign-in-alt me-1"></i>
                  <span data-en="Login" data-hi="à¤²à¥‰à¤— à¤‡à¤¨">Login</span>
                </a>
              </div>
            </div>
            <% } %>
            
            <% if (currentShop) { %>
            <div class="col-12">
              <div class="info-card p-3 bg-warning bg-opacity-10 rounded">
                <h6 class="text-warning mb-2">
                  <i class="fas fa-store me-2"></i>
                  <span data-en="Selected Shop" data-hi="à¤šà¤¯à¤¨à¤¿à¤¤ à¤¦à¥à¤•à¤¾à¤¨">Selected Shop</span>
                </h6>
                <p class="mb-0"><%= currentShop.name %></p>
                <small class="text-muted">
                  <span data-en="Shop ID" data-hi="à¤¦à¥à¤•à¤¾à¤¨ à¤†à¤ˆà¤¡à¥€">Shop ID</span>: <%= currentShop._id %>
                </small>
              </div>
            </div>
            <% } %>
            
            <div class="col-12">
              <div class="info-card p-3 bg-info bg-opacity-10 rounded">
                <h6 class="text-info mb-2">
                  <i class="fas fa-clock me-2"></i>
                  <span data-en="Session Info" data-hi="à¤¸à¤¤à¥à¤° à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€">Session Info</span>
                </h6>
                <p class="mb-1 small">
                  <span data-en="Status" data-hi="à¤¸à¥à¤¥à¤¿à¤¤à¤¿">Status</span>: 
                  <% if (session.user) { %>
                    <span class="badge bg-success" data-en="Logged In" data-hi="à¤²à¥‰à¤— à¤‡à¤¨">Logged In</span>
                  <% } else { %>
                    <span class="badge bg-secondary" data-en="Guest" data-hi="à¤…à¤¤à¤¿à¤¥à¤¿">Guest</span>
                  <% } %>
                </p>
                <p class="mb-0 small text-muted">
                  <span data-en="Session ID" data-hi="à¤¸à¤¤à¥à¤° à¤†à¤ˆà¤¡à¥€">Session ID</span>: <%= session.id || 'Browser Session' %>
                </p>
              </div>
            </div>
          </div>
      </div>
      <div class="modal-footer border-0">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          <span data-en="Close" data-hi="à¤¬à¤‚à¤¦ à¤•à¤°à¥‡à¤‚">Close</span>
        </button>
      </div>
    </div>
  </div>
</div>

<%- include("../partials/footer") %>

<script>
  // Language state management
  let currentLanguage = localStorage.getItem('language') || 'en';
  
  // Language translations
  const translations = {
    en: {
      toggleText: 'à¤¹à¤¿à¤‚',
      toggleTooltip: 'Switch to Hindi'
    },
    hi: {
      toggleText: 'EN',
      toggleTooltip: 'Switch to English'
    }
  };

  // Initialize language on page load
  document.addEventListener("DOMContentLoaded", () => {
    // Apply saved language
    if (currentLanguage === 'hi') {
      switchToHindi();
    } else {
      switchToEnglish();
    }
    
    // Update toggle button
    updateToggleButton();

    // Slider functionality
    const slider = document.getElementById('featuredSlider');
    const slideLeft = document.getElementById('slide-left');
    const slideRight = document.getElementById('slide-right');
    
    if (slideLeft && slideRight && slider) {
      const cardWidth = 250 + 16; // card width + gap
      
      slideLeft.addEventListener('click', () => {
        slider.scrollBy({ left: -cardWidth * 2, behavior: 'smooth' });
      });
      
      slideRight.addEventListener('click', () => {
        slider.scrollBy({ left: cardWidth * 2, behavior: 'smooth' });
      });
    }

    // Price update functionality
    function updateRates() {
      const metalsData = JSON.parse(localStorage.getItem("metalsData"));
      if (!metalsData) {
        console.warn("No metalsData found in localStorage");
        return;
      }

      const { gold, silver } = metalsData;

      // ðŸ”¹ Current Rates (10g for display only, without GST)
      const goldTotal10g = gold?.ratePerGram ? (gold.ratePerGram * 10) : 0;
      const silverTotal10g = silver?.ratePerGram ? (silver.ratePerGram * 10) : 0;

      document.querySelectorAll(".goldRate").forEach(el => {
        el.textContent = `â‚¹ ${goldTotal10g.toFixed(2)}`;
      });
      document.querySelectorAll(".silverRate").forEach(el => {
        el.textContent = `â‚¹ ${silverTotal10g.toFixed(2)}`;
      });

      // ðŸ”¹ Update each product card dynamically
      document.querySelectorAll(".price").forEach(el => {
        const priceType = el.dataset.pricetype;
        if (priceType === "manual") {
          el.textContent = `â‚¹ ${parseFloat(el.dataset.manual || 0).toFixed(2)}`;
          return; // âœ… Skip auto price calculation
        }

        const metal = el.dataset.metal;
        const weight = parseFloat(el.dataset.weight) || 1;

        let ratePerGram = 0;

        if (metal === "gold" && gold?.ratePerGram) {
          ratePerGram = gold.ratePerGram;
        } else if (metal === "silver" && silver?.ratePerGram) {
          ratePerGram = silver.ratePerGram;
        }

        const price = ratePerGram * weight;
        el.textContent = ratePerGram > 0 ? `â‚¹ ${price.toFixed(2)}` : "â‚¹ 0.00";
      });
    }

    // First run
    updateRates();

    // Update if metalsData changes from another tab or page
    window.addEventListener("storage", e => {
      if (e.key === "metalsData") updateRates();
    });

    // Periodic refresh (fallback)
    setInterval(updateRates, 5000);
  });

  // Language toggle function
  function toggleLanguage() {
    const elements = document.querySelectorAll('*');
    
    // Add fade out effect
    elements.forEach(el => el.classList.add('lang-transition'));
    
    setTimeout(() => {
      if (currentLanguage === 'en') {
        switchToHindi();
        currentLanguage = 'hi';
      } else {
        switchToEnglish();
        currentLanguage = 'en';
      }
      
      // Save to localStorage
      localStorage.setItem('language', currentLanguage);
      
      // Update toggle button
      updateToggleButton();
    }, 150);
  }

  function switchToHindi() {
    document.querySelectorAll('[data-hi]').forEach(element => {
      const hindiText = element.getAttribute('data-hi');
      if (hindiText) {
        element.textContent = hindiText;
        element.classList.add('hindi');
      }
    });
  }

  function switchToEnglish() {
    document.querySelectorAll('[data-en]').forEach(element => {
      const englishText = element.getAttribute('data-en');
      if (englishText) {
        element.textContent = englishText;
        element.classList.remove('hindi');
      }
    });
  }

  function updateToggleButton() {
    const toggleBtn = document.getElementById('languageToggle');
    const translation = translations[currentLanguage];
    
    toggleBtn.textContent = translation.toggleText;
    toggleBtn.setAttribute('title', translation.toggleTooltip);
    
    // Add visual feedback
    toggleBtn.style.transform = 'scale(1.1)';
    setTimeout(() => {
      toggleBtn.style.transform = 'scale(1)';
    }, 200);
  }

  // Keyboard shortcut for language toggle (Ctrl + L)
  document.addEventListener('keydown', function(e) {
    if (e.ctrlKey && e.key === 'l') {
      e.preventDefault();
      toggleLanguage();
    }
  });

  // User Info Modal functionality
  function showUserInfo() {
    const userInfoModal = new bootstrap.Modal(document.getElementById('userInfoModal'));
    userInfoModal.show();
  }

  // AGGRESSIVE fix for modal shaking
  document.addEventListener('DOMContentLoaded', function() {
    const modal = document.getElementById('userInfoModal');
    if (modal) {
      
      // Function to completely disable animations
      function disableAllAnimations() {
        const modalElements = modal.querySelectorAll('*');
        modalElements.forEach(element => {
          element.style.setProperty('transition', 'none', 'important');
          element.style.setProperty('transform', 'none', 'important');
          element.style.setProperty('animation', 'none', 'important');
          element.style.setProperty('will-change', 'auto', 'important');
          element.style.setProperty('backface-visibility', 'visible', 'important');
          
          // Remove all event listeners that might cause movement
          element.onmouseenter = null;
          element.onmouseleave = null;
          element.onmouseover = null;
          element.onmouseout = null;
          
          // Override any hover effects
          element.addEventListener('mouseenter', function(e) {
            e.preventDefault();
            e.stopPropagation();
            e.target.style.setProperty('transform', 'none', 'important');
            e.target.style.setProperty('transition', 'none', 'important');
            e.target.style.setProperty('box-shadow', 'none', 'important');
          }, true);
          
          element.addEventListener('mouseleave', function(e) {
            e.preventDefault();
            e.stopPropagation();
            e.target.style.setProperty('transform', 'none', 'important');
            e.target.style.setProperty('transition', 'none', 'important');
          }, true);
        });
      }
      
      // Apply fixes when modal is shown
      modal.addEventListener('show.bs.modal', disableAllAnimations);
      modal.addEventListener('shown.bs.modal', disableAllAnimations);
      
      // Also apply immediately if modal exists
      disableAllAnimations();
    }
  });

  // Admin FAB functionality
  let fabMenuOpen = false;

  function toggleAdminMenu() {
    const mainFab = document.getElementById('mainFab');
    const fabMenu = document.getElementById('fabMenu');
    
    fabMenuOpen = !fabMenuOpen;
    
    if (fabMenuOpen) {
      mainFab.classList.add('active');
      fabMenu.classList.add('show');
    } else {
      mainFab.classList.remove('active');
      fabMenu.classList.remove('show');
    }
  }

  // Close FAB menu when clicking outside
  document.addEventListener('click', function(e) {
    const fabContainer = document.querySelector('.admin-fab-container');
    if (fabContainer && !fabContainer.contains(e.target) && fabMenuOpen) {
      toggleAdminMenu();
    }
  });
</script>