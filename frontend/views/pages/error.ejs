<%- include('../partials/head') %> 
<%- include('../partials/header') %>

<style>
  .error-container {
    min-height: 80vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
    padding: 2rem 0;
  }

  .error-card {
    background: linear-gradient(135deg, #fff 0%, #fefefe 100%);
    border: 2px solid #e0bf50;
    border-radius: 15px;
    padding: 3rem;
    box-shadow: 0 8px 25px rgba(224, 191, 80, 0.1);
    text-align: center;
    max-width: 600px;
    width: 90%;
  }

  .error-icon {
    font-size: 4rem;
    color: #dc3545;
    margin-bottom: 1.5rem;
  }

  .error-title {
    color: #2c2c2c;
    font-weight: 700;
    margin-bottom: 1rem;
    font-size: 2rem;
  }

  .error-message {
    color: #6c757d;
    margin-bottom: 2rem;
    font-size: 1.1rem;
    line-height: 1.6;
  }

  .error-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .btn-home {
    background: linear-gradient(135deg, #e0bf50, #ffc107);
    border: none;
    color: #000;
    font-weight: 600;
    padding: 0.75rem 2rem;
    border-radius: 8px;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
  }

  .btn-home:hover {
    background: linear-gradient(135deg, #ffc107, #ffed4e);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(224, 191, 80, 0.3);
    color: #000;
    text-decoration: none;
  }

  .btn-back {
    background: linear-gradient(135deg, #6c757d, #868e96);
    border: none;
    color: #fff;
    font-weight: 600;
    padding: 0.75rem 2rem;
    border-radius: 8px;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
  }

  .btn-back:hover {
    background: linear-gradient(135deg, #868e96, #6c757d);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(108, 117, 125, 0.3);
    color: #fff;
    text-decoration: none;
  }

  .error-details {
    margin-top: 2rem;
    padding: 1rem;
    background: #f8f9fa;
    border-radius: 8px;
    text-align: left;
    font-family: monospace;
    font-size: 0.9rem;
    color: #495057;
    max-height: 200px;
    overflow-y: auto;
  }

  @media (max-width: 576px) {
    .error-card {
      padding: 2rem 1.5rem;
    }
    
    .error-title {
      font-size: 1.5rem;
    }
    
    .error-actions {
      flex-direction: column;
      align-items: center;
    }
    
    .btn-home, .btn-back {
      width: 100%;
      max-width: 200px;
    }
  }
</style>

<div class="error-container">
  <div class="error-card">
    <div class="error-icon">
      <% if (error.status === 404) { %>
        <i class="fas fa-search"></i>
      <% } else if (error.status === 403) { %>
        <i class="fas fa-lock"></i>
      <% } else if (error.status === 429) { %>
        <i class="fas fa-clock"></i>
      <% } else { %>
        <i class="fas fa-exclamation-triangle"></i>
      <% } %>
    </div>

    <h1 class="error-title">
      <% if (error.status === 404) { %>
        Page Not Found
      <% } else if (error.status === 403) { %>
        Access Denied
      <% } else if (error.status === 429) { %>
        Too Many Requests
      <% } else { %>
        Oops! Something went wrong
      <% } %>
    </h1>

    <p class="error-message">
      <% if (error.status === 404) { %>
        The page you're looking for doesn't exist. It might have been moved, deleted, or you entered the wrong URL.
      <% } else if (error.status === 403) { %>
        You don't have permission to access this resource. Please log in or contact the administrator.
      <% } else if (error.status === 429) { %>
        You've made too many requests. Please wait a moment before trying again.
      <% } else { %>
        <%= error.message || 'An unexpected error occurred. Please try again later.' %>
      <% } %>
    </p>

    <div class="error-actions">
      <a href="/products" class="btn-home">
        <i class="fas fa-home me-2"></i>
        Go Home
      </a>
      <a href="javascript:history.back()" class="btn-back">
        <i class="fas fa-arrow-left me-2"></i>
        Go Back
      </a>
    </div>

    <% if (error.stack && typeof error.stack === 'string') { %>
      <details class="mt-3">
        <summary style="cursor: pointer; color: #6c757d;">
          <small>Technical Details (for developers)</small>
        </summary>
        <div class="error-details">
          <%= error.stack %>
        </div>
      </details>
    <% } %>
  </div>
</div>

<script>
  // Auto-refresh for rate limit errors
  <% if (error.status === 429) { %>
    setTimeout(() => {
      window.location.reload();
    }, 60000); // Refresh after 1 minute
  <% } %>
  
  // Track error for analytics (optional)
  console.error('Page Error:', {
    status: <%= error.status || 500 %>,
    message: '<%= error.message %>',
    url: window.location.href,
    timestamp: new Date().toISOString()
  });
</script>

<%- include('../partials/footer') %>
