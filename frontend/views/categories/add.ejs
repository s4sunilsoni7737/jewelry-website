<%- include('../partials/head') %>
<%- include('../partials/header') %>
<%- include('../partials/messages') %>

<style>
  .info { font-size: 0.9rem; color: #6c757d; }

  .add-card { 
    width: 100%; 
    max-width: 800px; 
    margin: 1.5rem auto; 
    border: none;
    box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,0.075);
  }
  @media (max-width: 576px) { 
    .add-card { max-width: 95%; margin: 1rem auto; } 
  }

  .was-validated .form-control:invalid {
    border-color: #dc3545;
    box-shadow: none;
  }

  .form-section { margin-bottom: 2rem; }
  .form-section:last-child { margin-bottom: 1rem; }

  #icon { text-align: center; font-size: 1.5rem !important; }
</style>

<a type="button" class="btn btn-outline-warning back-button" href="/categories">
  <i class="fa-solid fa-arrow-left"></i>
</a>

<div class="container">
  <div class="card p-4 add-card">
    <h2 class="mb-3">Add Category</h2>
    <form id="addCategoryForm" class="needs-validation" action="/categories/add" method="POST" novalidate>

      <!-- Basic Information -->
      <div class="form-section">
        <h5 class="text-primary mb-3">Basic Information</h5>

        <!-- Category Name (English) -->
        <div class="form-group mb-3">
          <label for="name">Category Name (English)</label>
          <input type="text" class="form-control" id="name" name="name" required placeholder="e.g. Necklace, Ring">
          <div class="invalid-feedback">Please enter a category name in English.</div>
        </div>

        <!-- Category Name (Hindi) -->
        <div class="form-group mb-3">
          <label for="nameHindi">Category Name (Hindi)</label>
          <input type="text" class="form-control" id="nameHindi" name="nameHindi" required placeholder="e.g. à¤¹à¤¾à¤°, à¤…à¤‚à¤—à¥‚à¤ à¥€">
          <div class="invalid-feedback">Please enter a category name in Hindi.</div>
        </div>

        <!-- Category Icon -->
        <div class="form-group mb-3">
          <label for="icon">Category Icon</label>
          <input type="text" class="form-control" id="icon" name="icon" placeholder="ğŸ’" required maxlength="5">
          <div class="form-text">
            Use a single emoji or short icon (1â€“5 chars).<br>
            Suggestions: ğŸ’ğŸ’ğŸª¢ğŸ“¿ğŸ¦ªâšªï¸ğŸ«¶ğŸ»ğŸŒ™ğŸªğŸ¦¢âœ¨
          </div>
          <div class="invalid-feedback">Please enter a valid icon (1â€“5 characters).</div>
        </div>
      </div>

      <!-- Additional Information -->
      <div class="form-section">
        <h5 class="text-primary mb-3">Additional Information</h5>
        <div class="form-group mb-3">
          <label for="description">Description</label>
          <textarea class="form-control" id="description" name="description" rows="3" placeholder="Enter a brief description..." style="resize: vertical;"></textarea>
          <div class="form-text">Optional: Provide a brief description of this category.</div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="d-grid gap-2 d-md-flex justify-content-md-end">
        <a href="/categories" class="btn btn-secondary me-md-2">Cancel</a>
        <button type="submit" class="btn btn-primary">Add Category</button>
      </div>

    </form>
  </div>
</div>

<%- include('../partials/footer') %>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('addCategoryForm');
    const iconInput = document.getElementById('icon');

    // Real-time icon validation
    iconInput.addEventListener('input', function() {
      if (this.value.length > 5) {
        this.value = this.value.substring(0, 5);
      }
    });

    form.addEventListener('submit', function (event) {
      if (!form.checkValidity()) {
        event.preventDefault();
        event.stopPropagation();
      }
      form.classList.add('was-validated');
    }, false);
  });
</script>
